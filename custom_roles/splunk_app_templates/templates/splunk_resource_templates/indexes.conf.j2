# ===============================================================================
# indexes.conf - Generated by Splunk App Templates
# ===============================================================================
# Generated on: {{ ansible_date_time.iso8601 }}
# Tenant: {{ template_vars.tenant }}
# App: {{ template_vars.app_name }}
# Environment: {{ template_vars.environment }}
# ===============================================================================

{% for index_name, index_config in indexes.items() %}
[{{ index_name | lower }}]
# {{ index_config.description | default('Auto-generated index for ' + template_vars.app_name) }}
{% if index_config.max_data_size_mb is defined %}
maxDataSize = {{ index_config.max_data_size_mb }}MB
{% else %}
maxDataSize = auto
{% endif %}
{% if index_config.retention_period is defined %}
{% if index_config.retention_period | regex_search('D$') %}
maxDaysOld = {{ index_config.retention_period | regex_replace('D$', '') }}
{% elif index_config.retention_period | regex_search('Y$') %}
maxDaysOld = {{ (index_config.retention_period | regex_replace('Y$', '') | int * 365) }}
{% else %}
maxDaysOld = {{ index_config.retention_period }}
{% endif %}
{% endif %}
{% if index_config.max_hot_buckets is defined %}
maxHotBuckets = {{ index_config.max_hot_buckets }}
{% endif %}
{% if index_config.max_warm_buckets is defined %}
maxWarmDBCount = {{ index_config.max_warm_buckets }}
{% endif %}
{% if index_config.home_path is defined %}
homePath = {{ index_config.home_path }}
{% endif %}
{% if index_config.cold_path is defined %}
coldPath = {{ index_config.cold_path }}
{% endif %}
{% if index_config.thawed_path is defined %}
thawedPath = {{ index_config.thawed_path }}
{% endif %}
{% if index_config.bloom_filter_total_size_kb is defined %}
bloomfilterTotalSizeKB = {{ index_config.bloom_filter_total_size_kb }}
{% endif %}
{% if index_config.enable_data_integrity_control is defined %}
enableDataIntegrityControl = {{ index_config.enable_data_integrity_control | lower }}
{% endif %}
{% if index_config.enable_tsidx_reduction is defined %}
enableTsidxReduction = {{ index_config.enable_tsidx_reduction | lower }}
{% endif %}

{% endfor %}

# ===============================================================================
# Auto-generated metadata
# Template: {{ template_vars.app_name }}
# Generated by: {{ template_vars.deployed_by | default('ansible') }}
# Deployment method: {{ template_vars.deployment_method | default('ansible') }}
# ===============================================================================